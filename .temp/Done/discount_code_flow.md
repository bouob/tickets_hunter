# TicketPlus å„ªæƒ åºè™Ÿè¼¸å…¥åŠŸèƒ½ - ç¨‹å¼é‚è¼¯æµç¨‹åœ–

å®Œæ•´èªªæ˜æŠ˜åƒ¹åˆ¸è‡ªå‹•å¡«å…¥åŠŸèƒ½åœ¨æ•´å€‹æ¶ç¥¨æµç¨‹ä¸­çš„ä½ç½®èˆ‡é‹ä½œæ–¹å¼

---

## ğŸ“Š æ•´é«”æµç¨‹åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é–‹å§‹ TicketPlus æ¶ç¥¨æµç¨‹                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  1. ç™»å…¥ TicketPlus å¸³è™Ÿ       â”‚
    â”‚     nodriver_ticketplus_       â”‚
    â”‚     account_sign_in()          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  2. é¸æ“‡æ´»å‹•æ—¥æœŸ               â”‚
    â”‚     nodriver_ticketplus_       â”‚
    â”‚     date_auto_select()         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  3. é€²å…¥è¨‚ç¥¨é é¢ (/order/XXX/YYY)                  â”‚
    â”‚     nodriver_ticketplus_order()                    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  4. è‡ªå‹•é‡è¼‰æª¢æŸ¥                      â”‚
    â”‚     (API pending æˆ–æŒ‰éˆ• disabled)    â”‚
    â”‚     nodriver_ticketplus_order_       â”‚
    â”‚     auto_reload_coming_soon()        â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                  â”‚
    (pending)          (not pending)
         â”‚                  â”‚
         â–¼                  â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ é‡è¼‰é é¢â”‚     â”‚  5. é¸æ“‡ç¥¨ç¨®              â”‚
    â”‚ ç­‰å¾…é–‹è³£â”‚     â”‚     nodriver_ticketplus_ â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚     unified_select()     â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                      (é¸ç¥¨æˆåŠŸ)
                           â”‚
                           â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  6. è™•ç†æŠ˜åƒ¹åˆ¸ â­ (æ–°å¢åŠŸèƒ½)                 â”‚
          â”‚     nodriver_ticketplus_order_             â”‚
          â”‚     exclusive_code()                       â”‚
          â”‚                                            â”‚
          â”‚  Line 6665 å‘¼å«                             â”‚
          â”‚  Line 6764-6846 å¯¦ä½œ                       â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  7. å‹¾é¸åŒæ„æ¢æ¬¾          â”‚
          â”‚     nodriver_ticketplus_ â”‚
          â”‚     ticket_agree()       â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  8. é»æ“Šã€Œä¸‹ä¸€æ­¥ã€æŒ‰éˆ•     â”‚
          â”‚     nodriver_ticketplus_ â”‚
          â”‚     click_next_button_   â”‚
          â”‚     unified()            â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  9. é€²å…¥æ’éšŠ / ç¢ºèªé é¢   â”‚
          â”‚     (ç­‰å¾…æ¶ç¥¨çµæœ)        â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” æŠ˜åƒ¹åˆ¸è™•ç†è©³ç´°æµç¨‹

### å‘¼å«ä½ç½®ï¼š`nodriver_tixcraft.py` Line 6665

```python
# è™•ç†å„ªæƒ ç¢¼
is_answer_sent, ticketplus_dict["fail_list"], is_question_popup = \
    await nodriver_ticketplus_order_exclusive_code(tab, config_dict, ticketplus_dict["fail_list"])
```

**å‘¼å«æ™‚æ©Ÿ**ï¼š
- âœ… ç¥¨ç¨®é¸æ“‡æˆåŠŸå¾Œ (`is_price_assign_by_bot = True`)
- âœ… æäº¤è¡¨å–®ä¹‹å‰
- âœ… åœ¨ã€Œä¸‹ä¸€æ­¥ã€æŒ‰éˆ•é»æ“Šä¹‹å‰

---

### å‡½æ•¸å¯¦ä½œï¼š`nodriver_tixcraft.py` Line 6764-6846

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  nodriver_ticketplus_order_exclusive_code()                 â”‚
â”‚  è™•ç†æ´»å‹•å°ˆå±¬ä»£ç¢¼ï¼ˆæŠ˜åƒ¹åˆ¸/å„ªæƒ åºè™Ÿï¼‰                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  æª¢æŸ¥ 1: æš«åœç‹€æ…‹                       â”‚
    â”‚  if await check_and_handle_pause():   â”‚
    â”‚      return False, fail_list, False   â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ (æœªæš«åœ)
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  æª¢æŸ¥ 2: è®€å–æŠ˜åƒ¹åˆ¸ä»£ç¢¼è¨­å®š                         â”‚
    â”‚  discount_code = config_dict["advanced"]          â”‚
    â”‚      .get("ticketplus_discount_code", "").strip() â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    (æ˜¯å¦æœ‰è¨­å®š?)
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
    â”‚           â”‚
  (ç©º)      (æœ‰å€¼)
    â”‚           â”‚
    â–¼           â–¼
â”Œâ”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è·³é â”‚   â”‚  æº–å‚™ JavaScript æ³¨å…¥             â”‚
â”‚ è™•ç† â”‚   â”‚  1. å­—ä¸²è½‰ç¾©ï¼ˆé¿å…æ³¨å…¥æ”»æ“Šï¼‰       â”‚
â””â”€â”€â”€â”€â”€â”˜   â”‚     escaped_discount_code =       â”‚
          â”‚     discount_code.replace(...)     â”‚
          â”‚                                    â”‚
          â”‚  2. åŸ·è¡Œ JavaScript                â”‚
          â”‚     result = await tab.evaluate(   â”‚
          â”‚         JavaScript ç¨‹å¼ç¢¼)          â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  JavaScript åŸ·è¡Œå…§å®¹                       â”‚
    â”‚                                           â”‚
    â”‚  é—œéµå­—æ¸…å–®ï¼š['åºè™Ÿ', 'åŠ è³¼', 'å„ªæƒ ']       â”‚
    â”‚  filledCount = 0                          â”‚
    â”‚                                           â”‚
    â”‚  æ­¥é©Ÿï¼š                                    â”‚
    â”‚  1. æŸ¥æ‰¾æ‰€æœ‰ .exclusive-code .label       â”‚
    â”‚  2. æª¢æŸ¥ labelText æ˜¯å¦åŒ…å«é—œéµå­—          â”‚
    â”‚  3. æ‰¾åˆ°å°æ‡‰çš„ input æ¬„ä½                  â”‚
    â”‚  4. å¡«å…¥æŠ˜åƒ¹åˆ¸ä»£ç¢¼                         â”‚
    â”‚  5. è§¸ç™¼ Vue.js äº‹ä»¶ (input, change)      â”‚
    â”‚                                           â”‚
    â”‚  return {                                 â”‚
    â”‚      success: filledCount > 0,            â”‚
    â”‚      filledCount: filledCount             â”‚
    â”‚  }                                        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  è™•ç†è¿”å›çµæœ                         â”‚
    â”‚  (æ”¯æ´ dict / list / å…¶ä»–é¡å‹)       â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
    â”‚           â”‚
(æˆåŠŸ)      (å¤±æ•—)
    â”‚           â”‚
    â–¼           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”
â”‚è¼¸å‡ºï¼šâ”‚   â”‚è¼¸å‡ºï¼šâ”‚
â”‚æˆåŠŸ  â”‚   â”‚æœªæ‰¾åˆ°â”‚
â”‚å¡«å…¥N â”‚   â”‚æ¬„ä½  â”‚
â”‚å€‹æ¬„ä½â”‚   â”‚      â”‚
â””â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”˜
    â”‚           â”‚
    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¿”å›å€¼                      â”‚
â”‚  (is_answer_sent,           â”‚
â”‚   fail_list,                â”‚
â”‚   is_question_popup)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ é—œéµé‚è¼¯èªªæ˜

### 1. **é—œéµå­—åŒ¹é…ç­–ç•¥** (Line 6788)

```javascript
const keywords = ['åºè™Ÿ', 'åŠ è³¼', 'å„ªæƒ '];
```

**åŒ¹é…ç›®æ¨™**ï¼š
- âœ… ã€Œå„ªæƒ åºè™Ÿã€
- âœ… ã€ŒåŠ è³¼åºè™Ÿã€
- âœ… ã€Œå°ˆå±¬åºè™Ÿã€
- âœ… ä»»ä½•åŒ…å«é€™äº›é—œéµå­—çš„æ¨™ç±¤

**ç‚ºä»€éº¼é€™æ¨£è¨­è¨ˆï¼Ÿ**
- éˆæ´»æ‡‰å°ä¸åŒçš„å‘½åæ–¹å¼
- ç„¡éœ€ç²¾ç¢ºåŒ¹é…å®Œæ•´æ–‡å­—
- å¯ä»¥è¦†è“‹å¤§éƒ¨åˆ†æƒ…æ³

---

### 2. **å…ƒç´ é¸æ“‡å™¨ç­–ç•¥** (Line 6793-6809)

```javascript
// æ­¥é©Ÿ 1: æ‰¾åˆ°æ¨™ç±¤å®¹å™¨
const labelDivs = document.querySelectorAll('.exclusive-code .label');

// æ­¥é©Ÿ 2: éæ­·æ¯å€‹æ¨™ç±¤
for (let label of labelDivs) {
    const labelText = label.textContent.trim();
    const container = label.closest('.exclusive-code');

    // æ­¥é©Ÿ 3: æ‰¾åˆ°å°æ‡‰çš„è¼¸å…¥æ¡†
    const input = container.querySelector('.v-text-field__slot input[type="text"]');

    // æ­¥é©Ÿ 4: æª¢æŸ¥é—œéµå­—åŒ¹é…
    const hasKeyword = keywords.some(keyword => labelText.includes(keyword));

    // æ­¥é©Ÿ 5: å¡«å…¥ä»£ç¢¼
    if (hasKeyword && input && !input.value) {
        input.value = discountCode;
        input.dispatchEvent(new Event('input', { bubbles: true }));
        input.dispatchEvent(new Event('change', { bubbles: true }));
        filledCount++;
    }
}
```

**HTML çµæ§‹åƒè€ƒ**ï¼š
```html
<div class="exclusive-code">
    <div class="label">å„ªæƒ åºè™Ÿ</div>
    <div class="v-text-field__slot">
        <input type="text" placeholder="è«‹è¼¸å…¥å„ªæƒ åºè™Ÿ">
    </div>
</div>
```

---

### 3. **Vue.js äº‹ä»¶è§¸ç™¼** (Line 6805-6806)

```javascript
input.dispatchEvent(new Event('input', { bubbles: true }));
input.dispatchEvent(new Event('change', { bubbles: true }));
```

**ç‚ºä»€éº¼éœ€è¦è§¸ç™¼äº‹ä»¶ï¼Ÿ**
- TicketPlus ä½¿ç”¨ Vue.js æ¡†æ¶
- ç›´æ¥ä¿®æ”¹ `input.value` ä¸æœƒè¢« Vue åµæ¸¬åˆ°
- å¿…é ˆè§¸ç™¼ `input` å’Œ `change` äº‹ä»¶é€šçŸ¥ Vue
- `bubbles: true` è®“äº‹ä»¶å‘ä¸Šå†’æ³¡ï¼Œç¢ºä¿è¢«æ•æ‰

---

### 4. **å®‰å…¨æ€§è™•ç†** (Line 6786)

```python
# è½‰ç¾© JavaScript å­—ä¸²ï¼Œé¿å…æ³¨å…¥æ”»æ“Š
escaped_discount_code = discount_code.replace("\\", "\\\\") \
                                     .replace("'", "\\'") \
                                     .replace("\n", "\\n") \
                                     .replace("\r", "\\r")
```

**é˜²æ­¢çš„æ”»æ“Š**ï¼š
```javascript
// å¦‚æœæŠ˜åƒ¹åˆ¸ä»£ç¢¼æ˜¯ï¼šTEST'; alert('hacked
// ä¸è½‰ç¾©æœƒè®Šæˆï¼šconst discountCode = 'TEST'; alert('hacked';
// è½‰ç¾©å¾Œè®Šæˆï¼šconst discountCode = 'TEST\'; alert(\'hacked';
```

---

### 5. **å¤šæ¬„ä½æ”¯æ´** (Line 6807)

```javascript
filledCount++;  // è¨ˆæ•¸å™¨ç´¯åŠ 
```

**è¡Œç‚º**ï¼š
- âœ… è‡ªå‹•åµæ¸¬æ‰€æœ‰ç¬¦åˆé—œéµå­—çš„æ¬„ä½
- âœ… å…¨éƒ¨å¡«å…¥ç›¸åŒçš„æŠ˜åƒ¹åˆ¸ä»£ç¢¼
- âœ… æ”¯æ´é é¢ä¸Šæœ‰å¤šå€‹æŠ˜åƒ¹åˆ¸æ¬„ä½çš„æƒ…æ³

**ç¯„ä¾‹**ï¼š
```
é é¢ä¸Šæœ‰ï¼š
- å„ªæƒ åºè™Ÿ â†’ å¡«å…¥ "TEST123"
- åŠ è³¼åºè™Ÿ â†’ å¡«å…¥ "TEST123"

çµæœï¼šfilledCount = 2
```

---

## ğŸ“ Debug è¨Šæ¯è¼¸å‡º

### å®Œæ•´çš„ Debug è¨Šæ¯æµç¨‹

```python
# 1. å˜—è©¦å¡«å…¥
if show_debug_message:
    print(f"[DISCOUNT CODE] Attempting to fill discount code: {discount_code}")

# 2. æˆåŠŸå¡«å…¥
if show_debug_message:
    print(f"[DISCOUNT CODE] Successfully filled {filled_count} discount code field(s)")

# 3. æœªæ‰¾åˆ°æ¬„ä½
if show_debug_message:
    print("[DISCOUNT CODE] No matching discount code fields found on page")

# 4. æœªè¨­å®šä»£ç¢¼
if show_debug_message:
    print("[DISCOUNT CODE] No discount code configured, skipping")

# 5. éŒ¯èª¤è™•ç†
if show_debug_message:
    print(f"[DISCOUNT CODE] Error filling discount code: {str(e)}")
```

---

## ğŸ”„ èˆ‡å…¶ä»–åŠŸèƒ½çš„é—œè¯

### å‰ç½®æ¢ä»¶

1. âœ… **ç¥¨ç¨®é¸æ“‡å¿…é ˆæˆåŠŸ** (`is_price_assign_by_bot = True`)
   - å¦‚æœé¸ç¥¨å¤±æ•—ï¼Œä¸æœƒåŸ·è¡ŒæŠ˜åƒ¹åˆ¸è™•ç†
   - é‚è¼¯ä½ç½®ï¼šLine 6656

2. âœ… **ç¨‹å¼æœªæš«åœ** (`check_and_handle_pause()`)
   - å¦‚æœåµæ¸¬åˆ°æš«åœæª”æ¡ˆï¼Œç«‹å³è¿”å›
   - é‚è¼¯ä½ç½®ï¼šLine 6769

3. âœ… **æœ‰è¨­å®šæŠ˜åƒ¹åˆ¸ä»£ç¢¼** (`ticketplus_discount_code != ""`)
   - å¦‚æœæœªè¨­å®šï¼Œè·³éè™•ç†
   - é‚è¼¯ä½ç½®ï¼šLine 6776

### å¾ŒçºŒæ­¥é©Ÿ

1. **å‹¾é¸åŒæ„æ¢æ¬¾** (Line 6672)
   - `nodriver_ticketplus_ticket_agree()`
   - ç­‰å¾… 0.3 ç§’å¾ŒåŸ·è¡Œ

2. **é»æ“Šä¸‹ä¸€æ­¥æŒ‰éˆ•** (Line 6675)
   - `nodriver_ticketplus_click_next_button_unified()`
   - æäº¤è¨‚å–®è¡¨å–®

3. **é€²å…¥æ’éšŠç›£æ§** (Line 6684)
   - `nodriver_ticketplus_check_queue_status()`
   - ç­‰å¾…æ¶ç¥¨çµæœ

---

## âš™ï¸ è¨­å®šæª”æ•´åˆ

### settings.json

```json
{
  "advanced": {
    "ticketplus_discount_code": "YOUR_CODE_HERE"
  }
}
```

### settings.html (UI)

```html
<div class="input-group mt-2">
  <span class="input-group-text">æŠ˜åƒ¹åˆ¸</span>
  <input type="text" id="ticketplus_discount_code"
         placeholder="å„ªæƒ åºè™Ÿ / åŠ è³¼åºè™Ÿ">
</div>
```

### settings.js (è®€å–/å„²å­˜)

```javascript
// è®€å–
ticketplus_discount_code.value = settings.advanced.ticketplus_discount_code || '';

// å„²å­˜
settings.advanced.ticketplus_discount_code = ticketplus_discount_code.value;
```

---

## ğŸ¯ ä½¿ç”¨æƒ…å¢ƒç¯„ä¾‹

### æƒ…å¢ƒ 1ï¼šæœ‰æŠ˜åƒ¹åˆ¸ä»£ç¢¼

```
ä½¿ç”¨è€…è¨­å®šï¼šticketplus_discount_code = "SUMMER2025"

åŸ·è¡Œæµç¨‹ï¼š
1. é€²å…¥è¨‚ç¥¨é é¢
2. é¸æ“‡ç¥¨ç¨®æˆåŠŸ
3. åµæ¸¬åˆ°æŠ˜åƒ¹åˆ¸æ¬„ä½ã€Œå„ªæƒ åºè™Ÿã€
4. è‡ªå‹•å¡«å…¥ "SUMMER2025"
5. è§¸ç™¼ Vue.js äº‹ä»¶
6. ç¹¼çºŒæäº¤è¡¨å–®

Logs è¼¸å‡ºï¼š
[DISCOUNT CODE] Attempting to fill discount code: SUMMER2025
[DISCOUNT CODE] Successfully filled 1 discount code field(s)
```

### æƒ…å¢ƒ 2ï¼šç„¡æŠ˜åƒ¹åˆ¸ä»£ç¢¼

```
ä½¿ç”¨è€…è¨­å®šï¼šticketplus_discount_code = ""

åŸ·è¡Œæµç¨‹ï¼š
1. é€²å…¥è¨‚ç¥¨é é¢
2. é¸æ“‡ç¥¨ç¨®æˆåŠŸ
3. æª¢æŸ¥æŠ˜åƒ¹åˆ¸è¨­å®š â†’ ç©ºå­—ä¸²
4. è·³éæŠ˜åƒ¹åˆ¸è™•ç†
5. ç›´æ¥æäº¤è¡¨å–®

Logs è¼¸å‡ºï¼š
[DISCOUNT CODE] No discount code configured, skipping
```

### æƒ…å¢ƒ 3ï¼šé é¢ç„¡æŠ˜åƒ¹åˆ¸æ¬„ä½

```
ä½¿ç”¨è€…è¨­å®šï¼šticketplus_discount_code = "TEST123"

åŸ·è¡Œæµç¨‹ï¼š
1. é€²å…¥è¨‚ç¥¨é é¢
2. é¸æ“‡ç¥¨ç¨®æˆåŠŸ
3. å˜—è©¦æŸ¥æ‰¾æŠ˜åƒ¹åˆ¸æ¬„ä½
4. æœªæ‰¾åˆ°ä»»ä½•ç¬¦åˆé—œéµå­—çš„æ¬„ä½
5. è¿”å›å¤±æ•—ï¼Œä½†ä¸å½±éŸ¿å¾ŒçºŒæµç¨‹
6. ç¹¼çºŒæäº¤è¡¨å–®

Logs è¼¸å‡ºï¼š
[DISCOUNT CODE] Attempting to fill discount code: TEST123
[DISCOUNT CODE] No matching discount code fields found on page
```

---

## ğŸ” ç¨‹å¼ç¢¼ä½ç½®ç´¢å¼•

| åŠŸèƒ½ | æª”æ¡ˆ | è¡Œæ•¸ | èªªæ˜ |
|------|------|------|------|
| å‡½æ•¸å‘¼å« | `nodriver_tixcraft.py` | 6665 | åœ¨ç¥¨ç¨®é¸æ“‡æˆåŠŸå¾Œå‘¼å« |
| å‡½æ•¸å®šç¾© | `nodriver_tixcraft.py` | 6764-6846 | å®Œæ•´å¯¦ä½œé‚è¼¯ |
| JavaScript æ³¨å…¥ | `nodriver_tixcraft.py` | 6789-6816 | æŠ˜åƒ¹åˆ¸å¡«å…¥é‚è¼¯ |
| å®‰å…¨æ€§è™•ç† | `nodriver_tixcraft.py` | 6786 | å­—ä¸²è½‰ç¾© |
| è¨­å®šæ¬„ä½ | `settings.json` | 75 | `ticketplus_discount_code` |
| UI è¼¸å…¥æ¡† | `settings.html` | 876-879 | æŠ˜åƒ¹åˆ¸è¼¸å…¥æ¬„ä½ |
| JS è®€å– | `settings.js` | 224 | è¼‰å…¥è¨­å®šå€¼ |
| JS å„²å­˜ | `settings.js` | 462 | å„²å­˜è¨­å®šå€¼ |

---

## âœ… ç¸½çµ

å„ªæƒ åºè™Ÿè¼¸å…¥åŠŸèƒ½ï¼š
- **ä½ç½®**ï¼šç¥¨ç¨®é¸æ“‡æˆåŠŸå¾Œã€æäº¤è¡¨å–®ä¹‹å‰
- **è§¸ç™¼æ¢ä»¶**ï¼šæœ‰è¨­å®šæŠ˜åƒ¹åˆ¸ä»£ç¢¼ä¸”æœªæš«åœ
- **åŒ¹é…ç­–ç•¥**ï¼šé—œéµå­—åŒ¹é…ï¼ˆåºè™Ÿã€åŠ è³¼ã€å„ªæƒ ï¼‰
- **å¡«å…¥æ–¹å¼**ï¼šJavaScript æ³¨å…¥ + Vue.js äº‹ä»¶è§¸ç™¼
- **å¤šæ¬„ä½**ï¼šè‡ªå‹•åµæ¸¬ä¸¦å¡«å…¥æ‰€æœ‰ç¬¦åˆçš„æ¬„ä½
- **å®‰å…¨æ€§**ï¼šå­—ä¸²è½‰ç¾©é˜²æ­¢æ³¨å…¥æ”»æ“Š
- **éŒ¯èª¤è™•ç†**ï¼šæ‰¾ä¸åˆ°æ¬„ä½ä¸å ±éŒ¯ï¼Œä¸å½±éŸ¿å¾ŒçºŒæµç¨‹
