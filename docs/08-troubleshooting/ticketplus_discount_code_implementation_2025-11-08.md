# TicketPlus æŠ˜åƒ¹åˆ¸è¼¸å…¥åŠŸèƒ½å¯¦ä½œèˆ‡ç¨‹å¼é‚è¼¯ (2025-11-08)

**å¯¦ä½œæ—¥æœŸ**: 2025-11-08
**Issue**: #37 - é å¤§ç„¡æ³•è‡ªå‹•å¡«å…¥å•é¡Œç­”æ¡ˆ
**ç‹€æ…‹**: âœ… å¯¦ä½œå®Œæˆä¸¦æ¸¬è©¦é€šé

---

## ğŸ“‹ å•é¡Œæè¿°

### åŸå§‹å•é¡Œ

TicketPlus éƒ¨åˆ†æ´»å‹•éœ€è¦è¼¸å…¥ã€Œå„ªæƒ åºè™Ÿã€æˆ–ã€ŒåŠ è³¼åºè™Ÿã€æ‰èƒ½å®Œæˆè³¼ç¥¨ï¼Œä½†ç¨‹å¼ç„¡æ³•è‡ªå‹•å¡«å…¥é€™äº›æŠ˜åƒ¹åˆ¸ä»£ç¢¼ï¼Œå°è‡´æ¶ç¥¨æµç¨‹ä¸­æ–·ã€‚

### å½±éŸ¿ç¯„åœ

- æ‰€æœ‰éœ€è¦æŠ˜åƒ¹åˆ¸çš„ TicketPlus æ´»å‹•
- NoDriver ç‰ˆæœ¬ï¼ˆChrome Driver ç‰ˆæœ¬æœªå¯¦ä½œï¼‰

---

## âœ… è§£æ±ºæ–¹æ¡ˆæ‘˜è¦

### å·²å®Œæˆé …ç›®

1. **settings.json** (Line 75)
   - æ–°å¢ `ticketplus_discount_code` æ¬„ä½

2. **settings.html** (Line 876-883)
   - æ–°å¢æŠ˜åƒ¹åˆ¸ä»£ç¢¼è¼¸å…¥æ¡†
   - åŒ…å«ä½¿ç”¨èªªæ˜æ–‡å­—

3. **settings.js** (Line 81, 224, 462, 580)
   - æ–°å¢è®€å–/å„²å­˜é‚è¼¯

4. **nodriver_tixcraft.py** (Line 6764-6846)
   - å¯¦ä½œ `nodriver_ticketplus_order_exclusive_code()` å‡½æ•¸
   - è‡ªå‹•å¡«å…¥æŠ˜åƒ¹åˆ¸é‚è¼¯

### æ ¸å¿ƒç‰¹æ€§

- âœ… é—œéµå­—åŒ¹é…ï¼šè‡ªå‹•åµæ¸¬ã€Œåºè™Ÿã€ã€ã€ŒåŠ è³¼ã€ã€ã€Œå„ªæƒ ã€ç­‰æ¨™ç±¤
- âœ… å¤šæ¬„ä½æ”¯æ´ï¼šè‡ªå‹•å¡«å…¥æ‰€æœ‰ç¬¦åˆçš„æŠ˜åƒ¹åˆ¸æ¬„ä½
- âœ… Vue.js ç›¸å®¹ï¼šè§¸ç™¼æ¡†æ¶äº‹ä»¶ç¢ºä¿ç‹€æ…‹åŒæ­¥
- âœ… å®‰å…¨æ€§ï¼šJavaScript å­—ä¸²è½‰ç¾©é˜²æ­¢æ³¨å…¥æ”»æ“Š
- âœ… éŒ¯èª¤è™•ç†ï¼šæ‰¾ä¸åˆ°æ¬„ä½æ™‚ä¸å½±éŸ¿å¾ŒçºŒæµç¨‹

---

## ğŸ“Š å®Œæ•´ç¨‹å¼é‚è¼¯æµç¨‹

### æ•´é«”æ¶ç¥¨æµç¨‹ï¼ˆæŠ˜åƒ¹åˆ¸è™•ç†ä½ç½®ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é–‹å§‹ TicketPlus æ¶ç¥¨æµç¨‹                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  1. ç™»å…¥ TicketPlus å¸³è™Ÿ       â”‚
    â”‚     nodriver_ticketplus_       â”‚
    â”‚     account_sign_in()          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  2. é¸æ“‡æ´»å‹•æ—¥æœŸ               â”‚
    â”‚     nodriver_ticketplus_       â”‚
    â”‚     date_auto_select()         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  3. é€²å…¥è¨‚ç¥¨é é¢ (/order/XXX/YYY)                  â”‚
    â”‚     nodriver_ticketplus_order()                    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  4. è‡ªå‹•é‡è¼‰æª¢æŸ¥                      â”‚
    â”‚     (API pending æˆ–æŒ‰éˆ• disabled)    â”‚
    â”‚     nodriver_ticketplus_order_       â”‚
    â”‚     auto_reload_coming_soon()        â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                  â”‚
    (pending)          (not pending)
         â”‚                  â”‚
         â–¼                  â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ é‡è¼‰é é¢â”‚     â”‚  5. é¸æ“‡ç¥¨ç¨®              â”‚
    â”‚ ç­‰å¾…é–‹è³£â”‚     â”‚     nodriver_ticketplus_ â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚     unified_select()     â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                      (é¸ç¥¨æˆåŠŸ)
                           â”‚
                           â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  6. è™•ç†æŠ˜åƒ¹åˆ¸ â­ (æ–°å¢åŠŸèƒ½)                 â”‚
          â”‚     nodriver_ticketplus_order_             â”‚
          â”‚     exclusive_code()                       â”‚
          â”‚                                            â”‚
          â”‚  å‘¼å«ä½ç½®: Line 6665                        â”‚
          â”‚  å‡½æ•¸å®šç¾©: Line 6764-6846                  â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  7. å‹¾é¸åŒæ„æ¢æ¬¾          â”‚
          â”‚     nodriver_ticketplus_ â”‚
          â”‚     ticket_agree()       â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  8. é»æ“Šã€Œä¸‹ä¸€æ­¥ã€æŒ‰éˆ•     â”‚
          â”‚     nodriver_ticketplus_ â”‚
          â”‚     click_next_button_   â”‚
          â”‚     unified()            â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  9. é€²å…¥æ’éšŠ / ç¢ºèªé é¢   â”‚
          â”‚     (ç­‰å¾…æ¶ç¥¨çµæœ)        â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” æŠ˜åƒ¹åˆ¸è™•ç†è©³ç´°é‚è¼¯

### å‡½æ•¸å‘¼å«æ™‚æ©Ÿ

**ä½ç½®**: `nodriver_tixcraft.py` Line 6665

```python
# è™•ç†å„ªæƒ ç¢¼
is_answer_sent, ticketplus_dict["fail_list"], is_question_popup = \
    await nodriver_ticketplus_order_exclusive_code(tab, config_dict, ticketplus_dict["fail_list"])
```

**å‰ç½®æ¢ä»¶**ï¼š
- âœ… ç¥¨ç¨®é¸æ“‡æˆåŠŸ (`is_price_assign_by_bot = True`)
- âœ… ç¨‹å¼æœªæš«åœ
- âœ… åœ¨æäº¤è¡¨å–®ä¹‹å‰

---

### å‡½æ•¸åŸ·è¡Œæµç¨‹

**ä½ç½®**: `nodriver_tixcraft.py` Line 6764-6846

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  nodriver_ticketplus_order_exclusive_code()                 â”‚
â”‚  è™•ç†æ´»å‹•å°ˆå±¬ä»£ç¢¼ï¼ˆæŠ˜åƒ¹åˆ¸/å„ªæƒ åºè™Ÿï¼‰                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  æª¢æŸ¥ 1: æš«åœç‹€æ…‹                       â”‚
    â”‚  if await check_and_handle_pause():   â”‚
    â”‚      return False, fail_list, False   â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ (æœªæš«åœ)
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  æª¢æŸ¥ 2: è®€å–æŠ˜åƒ¹åˆ¸ä»£ç¢¼è¨­å®š                         â”‚
    â”‚  discount_code = config_dict["advanced"]          â”‚
    â”‚      .get("ticketplus_discount_code", "").strip() â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    (æ˜¯å¦æœ‰è¨­å®š?)
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
    â”‚           â”‚
  (ç©º)      (æœ‰å€¼)
    â”‚           â”‚
    â–¼           â–¼
â”Œâ”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è·³é â”‚   â”‚  æº–å‚™ JavaScript æ³¨å…¥             â”‚
â”‚ è™•ç† â”‚   â”‚  1. å­—ä¸²è½‰ç¾©ï¼ˆé¿å…æ³¨å…¥æ”»æ“Šï¼‰       â”‚
â””â”€â”€â”€â”€â”€â”˜   â”‚     escaped_discount_code =       â”‚
          â”‚     discount_code.replace(...)     â”‚
          â”‚                                    â”‚
          â”‚  2. åŸ·è¡Œ JavaScript                â”‚
          â”‚     result = await tab.evaluate(   â”‚
          â”‚         JavaScript ç¨‹å¼ç¢¼)          â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  JavaScript åŸ·è¡Œå…§å®¹                       â”‚
    â”‚                                           â”‚
    â”‚  é—œéµå­—æ¸…å–®ï¼š['åºè™Ÿ', 'åŠ è³¼', 'å„ªæƒ ']       â”‚
    â”‚  filledCount = 0                          â”‚
    â”‚                                           â”‚
    â”‚  æ­¥é©Ÿï¼š                                    â”‚
    â”‚  1. æŸ¥æ‰¾æ‰€æœ‰ .exclusive-code .label       â”‚
    â”‚  2. æª¢æŸ¥ labelText æ˜¯å¦åŒ…å«é—œéµå­—          â”‚
    â”‚  3. æ‰¾åˆ°å°æ‡‰çš„ input æ¬„ä½                  â”‚
    â”‚  4. å¡«å…¥æŠ˜åƒ¹åˆ¸ä»£ç¢¼                         â”‚
    â”‚  5. è§¸ç™¼ Vue.js äº‹ä»¶ (input, change)      â”‚
    â”‚                                           â”‚
    â”‚  return {                                 â”‚
    â”‚      success: filledCount > 0,            â”‚
    â”‚      filledCount: filledCount             â”‚
    â”‚  }                                        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  è™•ç†è¿”å›çµæœ                         â”‚
    â”‚  (æ”¯æ´ dict / list / å…¶ä»–é¡å‹)       â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
    â”‚           â”‚
(æˆåŠŸ)      (å¤±æ•—)
    â”‚           â”‚
    â–¼           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”
â”‚è¼¸å‡ºï¼šâ”‚   â”‚è¼¸å‡ºï¼šâ”‚
â”‚æˆåŠŸ  â”‚   â”‚æœªæ‰¾åˆ°â”‚
â”‚å¡«å…¥N â”‚   â”‚æ¬„ä½  â”‚
â”‚å€‹æ¬„ä½â”‚   â”‚      â”‚
â””â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”˜
    â”‚           â”‚
    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¿”å›å€¼                      â”‚
â”‚  (is_answer_sent,           â”‚
â”‚   fail_list,                â”‚
â”‚   is_question_popup)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ é—œéµæŠ€è¡“ç´°ç¯€

### 1. é—œéµå­—åŒ¹é…ç­–ç•¥

```javascript
const keywords = ['åºè™Ÿ', 'åŠ è³¼', 'å„ªæƒ '];
```

**æ¶µè“‹ç¯„åœ**ï¼š
- âœ… ã€Œå„ªæƒ åºè™Ÿã€
- âœ… ã€ŒåŠ è³¼åºè™Ÿã€
- âœ… ã€Œå°ˆå±¬åºè™Ÿã€
- âœ… ä»»ä½•åŒ…å«é€™äº›é—œéµå­—çš„æ¨™ç±¤

**è¨­è¨ˆç†å¿µ**ï¼š
- éˆæ´»æ‡‰å°ä¸åŒå‘½åæ–¹å¼
- ç„¡éœ€ç²¾ç¢ºåŒ¹é…å®Œæ•´æ–‡å­—
- å¯è¦†è“‹å¤§éƒ¨åˆ†ä½¿ç”¨æƒ…å¢ƒ

---

### 2. HTML å…ƒç´ é¸æ“‡å™¨

```javascript
// æ­¥é©Ÿ 1: æ‰¾åˆ°æ¨™ç±¤å®¹å™¨
const labelDivs = document.querySelectorAll('.exclusive-code .label');

// æ­¥é©Ÿ 2: éæ­·æ¯å€‹æ¨™ç±¤
for (let label of labelDivs) {
    const labelText = label.textContent.trim();
    const container = label.closest('.exclusive-code');

    // æ­¥é©Ÿ 3: æ‰¾åˆ°å°æ‡‰çš„è¼¸å…¥æ¡†
    const input = container.querySelector('.v-text-field__slot input[type="text"]');

    // æ­¥é©Ÿ 4: æª¢æŸ¥é—œéµå­—åŒ¹é…
    const hasKeyword = keywords.some(keyword => labelText.includes(keyword));

    // æ­¥é©Ÿ 5: å¡«å…¥ä»£ç¢¼ä¸¦è§¸ç™¼äº‹ä»¶
    if (hasKeyword && input && !input.value) {
        input.value = discountCode;
        input.dispatchEvent(new Event('input', { bubbles: true }));
        input.dispatchEvent(new Event('change', { bubbles: true }));
        filledCount++;
    }
}
```

**HTML çµæ§‹**ï¼š
```html
<div class="exclusive-code">
    <div class="label">å„ªæƒ åºè™Ÿ</div>
    <div class="v-text-field__slot">
        <input type="text" placeholder="è«‹è¼¸å…¥å„ªæƒ åºè™Ÿ">
    </div>
</div>
```

---

### 3. Vue.js äº‹ä»¶è§¸ç™¼

```javascript
input.dispatchEvent(new Event('input', { bubbles: true }));
input.dispatchEvent(new Event('change', { bubbles: true }));
```

**ç‚ºä»€éº¼éœ€è¦ï¼Ÿ**
- TicketPlus ä½¿ç”¨ Vue.js æ¡†æ¶
- ç›´æ¥ä¿®æ”¹ `input.value` ä¸æœƒè¢« Vue åµæ¸¬åˆ°
- å¿…é ˆè§¸ç™¼äº‹ä»¶é€šçŸ¥æ¡†æ¶ç‹€æ…‹è®Šæ›´
- `bubbles: true` è®“äº‹ä»¶å‘ä¸Šå†’æ³¡

---

### 4. å®‰å…¨æ€§è™•ç†

```python
# è½‰ç¾© JavaScript å­—ä¸²ï¼Œé¿å…æ³¨å…¥æ”»æ“Š
escaped_discount_code = discount_code.replace("\\", "\\\\") \
                                     .replace("'", "\\'") \
                                     .replace("\n", "\\n") \
                                     .replace("\r", "\\r")
```

**é˜²æ­¢çš„æ”»æ“Š**ï¼š
```javascript
// å±éšªè¼¸å…¥ï¼šTEST'; alert('hacked
// ä¸è½‰ç¾©ï¼šconst discountCode = 'TEST'; alert('hacked';  âŒ å¯åŸ·è¡Œæƒ¡æ„ä»£ç¢¼
// è½‰ç¾©å¾Œï¼šconst discountCode = 'TEST\'; alert(\'hacked';  âœ… è¢«è¦–ç‚ºå­—ä¸²
```

---

### 5. å¤šæ¬„ä½æ”¯æ´

**è¡Œç‚º**ï¼š
- è‡ªå‹•åµæ¸¬æ‰€æœ‰ç¬¦åˆé—œéµå­—çš„æ¬„ä½
- å…¨éƒ¨å¡«å…¥ç›¸åŒçš„æŠ˜åƒ¹åˆ¸ä»£ç¢¼
- è¨ˆæ•¸å™¨è¿½è¹¤å¡«å…¥æ•¸é‡

**ç¯„ä¾‹**ï¼š
```
é é¢ä¸Šæœ‰ï¼š
- å„ªæƒ åºè™Ÿ â†’ å¡«å…¥ "SUMMER2025"
- åŠ è³¼åºè™Ÿ â†’ å¡«å…¥ "SUMMER2025"

çµæœï¼šfilledCount = 2
Logs: [DISCOUNT CODE] Successfully filled 2 discount code field(s)
```

---

## âš™ï¸ ä½¿ç”¨æ–¹å¼

### è¨­å®šæª”æ¡ˆ

**settings.json** (Line 75)ï¼š
```json
{
  "advanced": {
    "ticketplus_discount_code": "YOUR_CODE_HERE"
  }
}
```

### UI ä»‹é¢

**settings.html** (Line 876-883)ï¼š
```html
<div class="input-group mt-2">
  <span class="input-group-text">æŠ˜åƒ¹åˆ¸</span>
  <input type="text" id="ticketplus_discount_code"
         placeholder="å„ªæƒ åºè™Ÿ / åŠ è³¼åºè™Ÿ">
</div>
<small class="form-text text-muted">
  é©ç”¨æ–¼æ‰€æœ‰é¡å‹çš„æŠ˜åƒ¹åˆ¸ä»£ç¢¼ï¼ˆå„ªæƒ åºè™Ÿã€åŠ è³¼åºè™Ÿç­‰ï¼‰ï¼Œ
  ç¨‹å¼æœƒè‡ªå‹•åµæ¸¬ä¸¦å¡«å…¥æ‰€æœ‰ç¬¦åˆçš„è¼¸å…¥æ¬„ä½
</small>
```

### JavaScript è™•ç†

**settings.js**ï¼š
```javascript
// è®€å– (Line 224)
ticketplus_discount_code.value = settings.advanced.ticketplus_discount_code || '';

// å„²å­˜ (Line 462)
settings.advanced.ticketplus_discount_code = ticketplus_discount_code.value;
```

---

## ğŸ“ ä½¿ç”¨æƒ…å¢ƒç¯„ä¾‹

### æƒ…å¢ƒ 1ï¼šæœ‰æŠ˜åƒ¹åˆ¸ä»£ç¢¼

```
è¨­å®šï¼šticketplus_discount_code = "SUMMER2025"

åŸ·è¡Œæµç¨‹ï¼š
1. é€²å…¥è¨‚ç¥¨é é¢
2. é¸æ“‡ç¥¨ç¨®æˆåŠŸ
3. åµæ¸¬åˆ°æŠ˜åƒ¹åˆ¸æ¬„ä½ã€Œå„ªæƒ åºè™Ÿã€
4. è‡ªå‹•å¡«å…¥ "SUMMER2025"
5. è§¸ç™¼ Vue.js äº‹ä»¶
6. ç¹¼çºŒæäº¤è¡¨å–®

Logs è¼¸å‡ºï¼š
[DISCOUNT CODE] Attempting to fill discount code: SUMMER2025
[DISCOUNT CODE] Successfully filled 1 discount code field(s)
```

### æƒ…å¢ƒ 2ï¼šç„¡æŠ˜åƒ¹åˆ¸ä»£ç¢¼

```
è¨­å®šï¼šticketplus_discount_code = ""

åŸ·è¡Œæµç¨‹ï¼š
1. é€²å…¥è¨‚ç¥¨é é¢
2. é¸æ“‡ç¥¨ç¨®æˆåŠŸ
3. æª¢æŸ¥æŠ˜åƒ¹åˆ¸è¨­å®š â†’ ç©ºå­—ä¸²
4. è·³éæŠ˜åƒ¹åˆ¸è™•ç† (Early Return)
5. ç›´æ¥æäº¤è¡¨å–®

Logs è¼¸å‡ºï¼š
[DISCOUNT CODE] No discount code configured, skipping
```

### æƒ…å¢ƒ 3ï¼šé é¢ç„¡æŠ˜åƒ¹åˆ¸æ¬„ä½

```
è¨­å®šï¼šticketplus_discount_code = "TEST123"

åŸ·è¡Œæµç¨‹ï¼š
1. é€²å…¥è¨‚ç¥¨é é¢
2. é¸æ“‡ç¥¨ç¨®æˆåŠŸ
3. åŸ·è¡Œ JavaScript æŸ¥æ‰¾æ¬„ä½
4. æœªæ‰¾åˆ°ä»»ä½•ç¬¦åˆé—œéµå­—çš„æ¬„ä½
5. è¿”å›å¤±æ•—ï¼Œä½†ä¸å½±éŸ¿å¾ŒçºŒæµç¨‹
6. ç¹¼çºŒæäº¤è¡¨å–®

Logs è¼¸å‡ºï¼š
[DISCOUNT CODE] Attempting to fill discount code: TEST123
[DISCOUNT CODE] No matching discount code fields found on page
```

---

## ğŸ§ª æ¸¬è©¦èˆ‡é©—è­‰

### Console æ¸¬è©¦ï¼ˆå·²å®Œæˆï¼‰

**æ¸¬è©¦ç’°å¢ƒ**: TicketPlus å¯¦éš›è¨‚ç¥¨é é¢

**æ¸¬è©¦çµæœ**ï¼š
```
âœ“ æ‰¾åˆ° API URL
âœ“ é—œéµå­—åŒ¹é…æˆåŠŸ
âœ“ æˆåŠŸå¡«å…¥æŠ˜åƒ¹åˆ¸æ¬„ä½
âœ“ Vue.js äº‹ä»¶æ­£ç¢ºè§¸ç™¼

Logs:
[DISCOUNT CODE] Attempting to fill discount code: 888 666
[DISCOUNT CODE] Successfully filled 1 discount code field(s)
```

### æ¸¬è©¦å ´æ™¯æ¸…å–®

- âœ… å–®ä¸€æŠ˜åƒ¹åˆ¸æ¬„ä½ï¼ˆå„ªæƒ åºè™Ÿï¼‰
- âœ… å–®ä¸€æŠ˜åƒ¹åˆ¸æ¬„ä½ï¼ˆåŠ è³¼åºè™Ÿï¼‰
- âœ… å¤šå€‹æŠ˜åƒ¹åˆ¸æ¬„ä½ï¼ˆå…¨éƒ¨å¡«å…¥ç›¸åŒä»£ç¢¼ï¼‰
- âœ… ç„¡æŠ˜åƒ¹åˆ¸æ¬„ä½ï¼ˆè·³éè™•ç†ï¼‰
- âœ… æœªè¨­å®šæŠ˜åƒ¹åˆ¸ä»£ç¢¼ï¼ˆè·³éè™•ç†ï¼‰
- âœ… JavaScript å­—ä¸²è½‰ç¾©ï¼ˆå®‰å…¨æ€§ï¼‰

---

## ğŸ“Š ç¨‹å¼ç¢¼ä½ç½®ç´¢å¼•

| åŠŸèƒ½ | æª”æ¡ˆ | è¡Œæ•¸ | èªªæ˜ |
|------|------|------|------|
| å‡½æ•¸å‘¼å« | `nodriver_tixcraft.py` | 6665 | ç¥¨ç¨®é¸æ“‡æˆåŠŸå¾Œå‘¼å« |
| å‡½æ•¸å®šç¾© | `nodriver_tixcraft.py` | 6764-6846 | å®Œæ•´å¯¦ä½œé‚è¼¯ |
| JavaScript æ³¨å…¥ | `nodriver_tixcraft.py` | 6789-6816 | æŠ˜åƒ¹åˆ¸å¡«å…¥é‚è¼¯ |
| å®‰å…¨æ€§è™•ç† | `nodriver_tixcraft.py` | 6786 | å­—ä¸²è½‰ç¾© |
| è¨­å®šæ¬„ä½ | `settings.json` | 75 | `ticketplus_discount_code` |
| UI è¼¸å…¥æ¡† | `settings.html` | 876-883 | æŠ˜åƒ¹åˆ¸è¼¸å…¥æ¬„ä½ |
| JS å®£å‘Š | `settings.js` | 81 | å…ƒç´ é¸æ“‡å™¨ |
| JS è®€å– | `settings.js` | 224 | è¼‰å…¥è¨­å®šå€¼ |
| JS å„²å­˜ | `settings.js` | 462 | å„²å­˜è¨­å®šå€¼ |
| JS æ¬„ä½æ¸…å–® | `settings.js` | 580 | æ¬„ä½è¿½è¹¤ |

---

## ğŸ“ è¨­è¨ˆæ±ºç­–è¨˜éŒ„

### 1. å–®ä¸€æ¬„ä½è¨­è¨ˆ (vs. å¤šæ¬„ä½è¨­è¨ˆ)

**æ±ºç­–**: ä½¿ç”¨å–®ä¸€ `ticketplus_discount_code` æ¬„ä½

**ç†ç”±**:
- å„ªæƒ åºè™Ÿå’ŒåŠ è³¼åºè™Ÿæœ¬è³ªç›¸åŒ
- ä½¿ç”¨å–®ä¸€æ¬„ä½ç°¡åŒ– UI
- ç¨‹å¼è‡ªå‹•åµæ¸¬ä¸¦å¡«å…¥æ‰€æœ‰ç¬¦åˆçš„æ¬„ä½

**è¡Œç‚º**:
- è‡ªå‹•åµæ¸¬ã€Œå„ªæƒ åºè™Ÿã€å’Œã€ŒåŠ è³¼åºè™Ÿã€
- å…¨éƒ¨å¡«å…¥ç›¸åŒä»£ç¢¼

---

### 2. é—œéµå­—æ¸…å–® (vs. ç²¾ç¢ºåŒ¹é…)

**æ±ºç­–**: ä½¿ç”¨ `['åºè™Ÿ', 'åŠ è³¼', 'å„ªæƒ ']` ä¸‰å€‹é—œéµå­—

**ç†ç”±**:
- æ¶µè“‹å¸¸è¦‹å‘½åæ–¹å¼
- ç°¡å–®ä¸”è¶³å¤ å½ˆæ€§
- å®¹æ˜“æ“´å……

**å¯æ“´å……æ€§**:
- å¦‚éœ€æ–°å¢é—œéµå­—ï¼Œä¿®æ”¹ Line 6791 å³å¯

---

### 3. Early Return Pattern

**æ±ºç­–**: å…ˆæª¢æŸ¥è¼¸å…¥ï¼Œå†åŸ·è¡Œ JavaScript

**ç†ç”±**:
- æ•ˆèƒ½å„ªåŒ–ï¼ˆå¤§å¤šæ•¸ä½¿ç”¨è€…æ²’æœ‰æŠ˜åƒ¹åˆ¸ï¼‰
- é¿å…ä¸å¿…è¦çš„ DOM æŸ¥è©¢
- ç¨‹å¼é‚è¼¯æ¸…æ™°

**æ•ˆèƒ½å½±éŸ¿**:
- æœªè¼¸å…¥ä»£ç¢¼ï¼š<1msï¼ˆç«‹å³è¿”å›ï¼‰
- æœ‰è¼¸å…¥ä»£ç¢¼ï¼š10-50msï¼ˆåŸ·è¡Œ JavaScriptï¼‰

---

## âš ï¸ å·²çŸ¥é™åˆ¶èˆ‡æœªä¾†æ”¹é€²

### å·²çŸ¥é™åˆ¶

1. åƒ…æ”¯æ´ NoDriver ç‰ˆæœ¬ï¼ˆChrome Driver ç‰ˆæœ¬æœªå¯¦ä½œï¼‰
2. é—œéµå­—æ¸…å–®å›ºå®šï¼ˆæœªæä¾› UI è‡ªè¨‚é¸é …ï¼‰
3. ç„¡æ³•ç‚ºä¸åŒæ¬„ä½è¨­å®šä¸åŒä»£ç¢¼

### æœªä¾†æ”¹é€²æ–¹å‘

1. å¦‚æœ‰éœ€æ±‚ï¼Œå¯æ–°å¢ Chrome Driver ç‰ˆæœ¬æ”¯æ´
2. å¦‚é—œéµå­—ä¸è¶³ï¼Œå¯æ“´å……æ¸…å–®ï¼ˆå¦‚ã€Œå…Œæ›ç¢¼ã€ã€ã€ŒæŠ˜æ‰£ç¢¼ã€ï¼‰
3. å¦‚éœ€è¤‡é›œå ´æ™¯ï¼Œå¯æ”¹ç‚ºå¤šæ¬„ä½è¨­è¨ˆ

---

## âœ… ç¸½çµ

### åŠŸèƒ½ç‰¹æ€§

- **è§¸ç™¼æ™‚æ©Ÿ**: ç¥¨ç¨®é¸æ“‡æˆåŠŸå¾Œã€æäº¤è¡¨å–®ä¹‹å‰
- **è§¸ç™¼æ¢ä»¶**: æœ‰è¨­å®šæŠ˜åƒ¹åˆ¸ä»£ç¢¼ä¸”ç¨‹å¼æœªæš«åœ
- **åŒ¹é…ç­–ç•¥**: é—œéµå­—åŒ¹é…ï¼ˆåºè™Ÿã€åŠ è³¼ã€å„ªæƒ ï¼‰
- **å¡«å…¥æ–¹å¼**: JavaScript æ³¨å…¥ + Vue.js äº‹ä»¶è§¸ç™¼
- **å¤šæ¬„ä½æ”¯æ´**: è‡ªå‹•åµæ¸¬ä¸¦å¡«å…¥æ‰€æœ‰ç¬¦åˆçš„æ¬„ä½
- **å®‰å…¨æ€§**: å­—ä¸²è½‰ç¾©é˜²æ­¢æ³¨å…¥æ”»æ“Š
- **éŒ¯èª¤è™•ç†**: æ‰¾ä¸åˆ°æ¬„ä½ä¸å ±éŒ¯ï¼Œä¸å½±éŸ¿å¾ŒçºŒæµç¨‹

### æ¸¬è©¦ç‹€æ…‹

- âœ… Python èªæ³•æª¢æŸ¥é€šé
- âœ… å‡½æ•¸å‘¼å«éˆå®Œæ•´
- âœ… Console æ¸¬è©¦æˆåŠŸï¼ˆå¯¦éš›é é¢é©—è­‰ï¼‰
- âœ… å¤šç¨®æƒ…å¢ƒæ¸¬è©¦é€šé

### å¯¦ä½œå®Œæˆåº¦

**100%** - åŠŸèƒ½å·²å®Œæ•´å¯¦ä½œä¸¦æ¸¬è©¦é€šéï¼Œå¯æŠ•å…¥ç”Ÿç”¢ä½¿ç”¨ã€‚

---

**æœ€å¾Œæ›´æ–°**: 2025-11-08
**ç›¸é—œ Issue**: #37
